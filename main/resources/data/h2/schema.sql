/*
 * http://localhost:8080/h2-console
 * 
 * JDBC URL: jdbc:h2:mem:testdb
 * 
 */

DROP TABLE SECUENCIAS 			IF EXISTS;

DROP TABLE LINEAS_PEDIDO 		IF EXISTS;
DROP TABLE PEDIDOS 				IF EXISTS;

DROP TABLE CAMAREROS 			IF EXISTS;
DROP TABLE PRODUCTOS 			IF EXISTS;
DROP TABLE CONTACTOS_CLIENTE	IF EXISTS;
DROP TABLE CLIENTES 			IF EXISTS;


CREATE TABLE SECUENCIAS(
	SEQ_NAME	VARCHAR(100)	NOT NULL,
	SEQ_NUMBER	BIGINT			NOT NULL
);

CREATE TABLE CAMAREROS (
	ID				BIGINT			NOT NULL,
	NOMBRE			VARCHAR(100)	NOT NULL,
	PRIMARY KEY (ID)
);

CREATE TABLE PRODUCTOS (
	CODIGO			BIGINT			NOT NULL,
	NOMBRE			VARCHAR(100)	NOT NULL,
	PRECIO			DOUBLE			NOT NULL,
	DESCRIPCION		VARCHAR(100)	NOT NULL,
	FECHA_ALTA		TIMESTAMP		NOT NULL,
	DESCATALOGADO	BOOLEAN			NOT NULL,
	CATEGORIA		VARCHAR(100)	NOT NULL,
	PRIMARY KEY(CODIGO)
);


CREATE TABLE PEDIDOS (
	ID				BIGINT			NOT NULL,
	FECHA			TIMESTAMP		NOT NULL,
	MESA			INT				NOT NULL,
	ID_CAMARERO		BIGINT			NOT NULL,
	PRIMARY KEY (ID),
	FOREIGN KEY (ID_CAMARERO) REFERENCES CAMAREROS (ID)
);


CREATE TABLE LINEAS_PEDIDO (
--	ID				BIGINT			NOT NULL,
	ID_PEDIDO		BIGINT			NOT NULL,
	ID_PRODUCTO		BIGINT			NOT NULL,
	INDICE			INT,
	CANTIDAD		INT				NOT NULL,
	PRECIO			DOUBLE			NOT NULL,
	PRIMARY KEY (ID_PEDIDO, INDICE),
	FOREIGN KEY (ID_PEDIDO) REFERENCES PEDIDOS (ID),
	FOREIGN KEY (ID_PRODUCTO) REFERENCES PRODUCTOS (CODIGO),
);

CREATE TABLE CLIENTES (
	ID				BIGINT			NOT NULL,
	NOMBRE			VARCHAR(100)	NOT NULL,
	PRIMARY KEY (ID)
);

CREATE TABLE CONTACTOS_CLIENTE (
	NOMBRE			VARCHAR(199)	NOT NULL,
	TELEFONO		VARCHAR(15)		NOT NULL,
	ID_CLIENTE		BIGINT			NOT NULL,
	FOREIGN KEY (ID_CLIENTE) REFERENCES CLIENTES(ID)
)